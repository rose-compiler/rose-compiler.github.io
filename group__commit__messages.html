<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ROSE: Writing Git commit messages</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="ROSE"/>
<link href="roseDoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ROSE<span id="projectnumber">&#160;0.11.145.141</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,true,'search.html','Search');
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">Writing Git commit messages<div class="ingroups"><a class="el" href="group__developer__docs.html">Library developers and collaborators</a></div></div></div>
</div><!--header-->
<div class="contents">
<p>This document describes how to write good, useful commit messages. </p>
<p>The script that checks the policies stated here is called <code>good-commits.pl</code> in the ROSE "scripts" directory, and its usage is described below.</p>
<h1><a class="anchor" id="commit_messages_title"></a>
Titles</h1>
<ul>
<li>The title must start with a parenthesized category not more than 20 characters. </li>
<li>Titles must be short, single-line statements not more than 80 characters; details should go in the body. </li>
<li>The title and body must be separated by a single blank line.</li>
</ul>
<p>The parenthesized category is one or more words. The category's purpose is to make it easier for humans to quickly scan a long list of commits and see what they concern. The category names can be made up on the fly. Here are some examples:</p>
<table class="doxtable">
<tr>
<td><b>Examples</b></td><td><b>What they might mean</b> </td></tr>
<tr>
<td>Frontend, Binary Analysis</td><td>Some broad part of the ROSE library. </td></tr>
<tr>
<td>codethorn, compass2</td><td>A particular project that uses ROSE. </td></tr>
<tr>
<td>Attribute, Stack Delta</td><td>Some specific feature. </td></tr>
</table>
<p>The titles are intentionally short, but not as short as some best practices recommend. Some reasons for such short titles are:</p>
<ul>
<li>Tools and websites (e.g., Github, GitLab, qgit, Magit) have limited space in which to show a title and sometimes truncate the title if it's too long. </li>
<li>When looking at long lists of commit titles, it's easier to read them if they're terse. Additional details can always be added to the commit message body.</li>
</ul>
<p>Some examples of good titles:</p>
<ul>
<li>(Attributes) BinaryAnalysis::Attribute is moved </li>
<li>(move tool) one more test case for comments handling </li>
<li>(C++11) Minor fixes to compile ROSE with C++11 </li>
<li>(Tutorial) Fixed link error in tutorial</li>
</ul>
<h1><a class="anchor" id="commit_messages_body"></a>
Body</h1>
<p>The body provides details that are missing from the title and which are not easily evident from the patch. Some examples about what is good for a commit message body:</p>
<ul>
<li>The <b>general overview</b> of what changed. Often the patch is so detailed and/or spread out that it's hard to otherwise discern what really changed. For instance, if test answers are updated the commit should explain why the answer changed. </li>
<li>Warning to the user if a ROSE <b>API changed</b> in a way that is not backward compatible. </li>
<li>Where the commit came from, if not from the committer. For instance, if the commit was a patch submitted by a user it is polite to <b>thank the user</b> or the organization (provided they don't object). </li>
<li>If controversial, the commit should mention its <b>provenance</b>. Perhaps it came from developer consensus at a team meeting. Otherwise someone who wasn't privy to that information might revert the commit later. </li>
<li><b>Changes that affect users</b> should be listed including what the user needs to change in their own code. Some of our users know how to use Git and will either look through the commit messages before merging or will search the commit messages when they have a compile error due to changed names. (On a similar note, try not to change the API without first using ROSE_DEPRECATED for a suitable period of time.) </li>
<li>The body of the commit can be <b>formatted as Markdown</b>, which is readable to humans and can be displayed reasonably in user interfaces. The most useful Markdown in commit messages are: bullet lists introduced with asterisks, inline source code quoted in backticks, and multi-line source code delimited by lines containing three backticks.</li>
</ul>
<p>Make sure your message is spelled correctly since it cannot be changed once it's merged into a release branch&ndash;at least not without a very disruptive history rewrite. Commit messages are for posterity, so be careful. "I hate git", commit <a href="https://github.com/rose-compiler/rose/commit/a53823f">a53823f</a>, was unprofessional but is now effectively permanent.</p>
<h1><a class="anchor" id="commit_messages_issues"></a>
Issue references</h1>
<p>Every commit must reference at least one issue, and may reference multiple issues. The issues are listed after the message body and are separated from the body by a blank line. Issues are listed one per line. Each issue line has one of two forms:</p>
<ul>
<li>An all-uppercase word followed by a hyphen, followed by decimal digits. </li>
<li>The word "Issue" followed by a space, the number sign (#), decimal digits, and an optional plus sign. </li>
<li>The name of a Gitlab project followed immediately (no space) by the number sign, decimal digits, and an optional plus sign.</li>
</ul>
<p>Some examples of issue references:</p>
<table class="doxtable">
<tr>
<td><b>Example</b></td><td><b>What it means</b> </td></tr>
<tr>
<td>Issue #123</td><td>An issue in the ROSE Gitlab project at rosecompiler2.llnl.gov/gitlab. </td></tr>
<tr>
<td>Issue #123+</td><td>Similar, but will expand to the issue title when viewed in Gitlab. </td></tr>
<tr>
<td>ROSE#123+</td><td>An issue in the ROSE project changed to a reference by Gitlab. </td></tr>
<tr>
<td>RC-123</td><td>An issue in the ROSE Confluence instance. </td></tr>
<tr>
<td>JIRA-123</td><td>Issue number 123 in JIRA, which the ROSE team no longer uses. </td></tr>
</table>
<p>The purpose of issue references in commit messages is to provide context and help trace the history of changes. For instance, in Gitlab it's easy for developers to hold a lengthy discussion about an issue, but it's not as easy to change a commit message.</p>
<p>To search for commits that implement a certain issue, use a command like this:</p>
<div class="fragment"><div class="line">git log --grep <span class="stringliteral">&#39;^Issue #1234&#39;</span></div>
</div><!-- fragment --><h1><a class="anchor" id="commit_messages_checker"></a>
Commit message policy checker</h1>
<p>The <code>good-commits.pl</code> script in ROSE's "scripts" directory checks that commits follow the policy outlined here. It should be run from inside the ROSE repository.</p>
<p>When run with no arguments it will show one line per commit over the last 30 days for the current user and indicate whether the commit passes the policy checks, or why it fails.</p>
<p>To create a summary table with one row per author, run the script with the "--histogram" switch plus any additional commit-selecting switches that are passed to the <code>git rev-list</code> command. For instance, the table that we create for the weekly ROSE meetings is generated by running:</p>
<div class="fragment"><div class="line">good-commits.pl --histogram --no-merges --since <span class="stringliteral">&#39;1 month ago&#39;</span> origin/master</div>
</div><!-- fragment --><h1><a class="anchor" id="commit_messages_examples"></a>
Examples of good commit messages</h1>
<p>This commit message makes it clear what users must change in their code:</p>
<pre class="fragment">   (Binary Analysis) Changed names for some classes in the new SymbolicExpr
   
   **API CHANGE**

   SymbolicExpr::TreeNode         -&gt; SymbolicExpr::Node
   SymbolicExpr::TreeNodePtr      -&gt; SymbolicExpr::Ptr
   SymbolicExpr::LeafNodePtr      -&gt; SymbolicExpr::LeafPtr
   SymbolicExpr::InternalNodePtr  -&gt; SymbolicExpr::InternalPtr

   Issue #123
</pre><p>This commit makes it clear to the simulator2 project maintainer why a change was made since it was changed by someone that doesn't normally work on that project:</p>
<pre class="fragment">   (Simulator2) Add Linux conditional around statfs::f_flags
   
   `statfs::f_flags` is only available since Linux 2.6.36.
   Our internal RHEL5 testing servers are Linux 2.6.18.

   RC-123
</pre><p>This commit explains why a change was made, which is not evident from the change itself:</p>
<pre class="fragment">   (Git) Update .gitmodules to point to release repositories
   
   This decision was reached during a team meeting with Dan,
   Markus, Leo, Justin, and Pei-Hung.
   
   The solution:
   
   1. Merge the rose/scratch/edg.git branches into the
      rose/edg4x/edg.git repository.
   
   2. Update .gitmodules to point to the rose/edg4x/edg.git
      release repository.
   
   3. Remove the rose/scratch/edg.git repository once it
      has been entirely merged into the rose/edg4x/edg.git
      repository.

   ROSE-123
   JENKINS-456
</pre> <div class="dynheader">
Collaboration diagram for Writing Git commit messages:</div>
<div class="dyncontent">
<div class="center"><img src="group__commit__messages.png" border="0" usemap="#agroup____commit____messages" alt=""/></div>
<map name="agroup____commit____messages" id="agroup____commit____messages">
<area shape="rect" title="This document describes how to write good, useful commit messages." alt="" coords="181,5,312,45"/>
<area shape="rect" href="group__developer__docs.html" title="Documentation oriented toward those working on ROSE." alt="" coords="5,5,133,45"/>
</map>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Oct 2 2024 00:08:37 for ROSE by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
